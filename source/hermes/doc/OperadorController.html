<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: OperadorController
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!OperadorController.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (O)</a> &raquo;
    
    
    <span class="title">OperadorController</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: OperadorController
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="ApplicationController.html" title="ApplicationController (class)">ApplicationController</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActionController::Base</li>
          
            <li class="next"><span class='object_link'><a href="ApplicationController.html" title="ApplicationController (class)">ApplicationController</a></span></li>
          
            <li class="next">OperadorController</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">app/controllers/operador_controller.rb</dd>
  
</dl>
<div class="clear"></div>








  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#buscar_paquete-instance_method" title="#buscar_paquete (instance method)">- (Json) <strong>buscar_paquete</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Representacion en formato json de los paquetes encontrados.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cambiar_estado_paquete-instance_method" title="#cambiar_estado_paquete (instance method)">- (Json) <strong>cambiar_estado_paquete</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Representacion en formato json del paquete modificado o 400 en caso de
error.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_api_token-instance_method" title="#check_api_token (instance method)">- (Json) <strong>check_api_token</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>La representacion de un mensaje 403 en  caso de acceso no autorizado o no
contener el parametro &#39;api-token&#39; en la cabecera.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#crear_paquete-instance_method" title="#crear_paquete (instance method)">- (Json) <strong>crear_paquete</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Representacion en formato json del numero guia correspondiente al paquete
creado o 400 en caso de error.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ver_paquete-instance_method" title="#ver_paquete (instance method)">- (Json) <strong>ver_paquete</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Representacion en formato json del paquete modificado o 400 en caso de
error.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="buscar_paquete-instance_method">
  
    - (<tt>Json</tt>) <strong>buscar_paquete</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>GET &#39;/operador/paquete/buscar&#39;</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Parametro &#39;api-token&#39; requerido en cabecera HTTP</p>
</div>
  </div>


<p>Returns representacion en formato json de los paquetes encontrados.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Ejemplo de json en caso de retorno</p>
</div></p>
      
      <pre class="example code"><code>{
    &quot;err_mssg&quot;: &quot;&quot;,
    &quot;success_mssg&quot;: &quot;OK&quot;,
    &quot;data&quot;: {
        &quot;como_emisor&quot;: [
            {
                &quot;id&quot;: 15,
                &quot;ancho&quot;: 5,
                &quot;alto&quot;: 5,
                &quot;peso&quot;: 0.15,
                &quot;costo&quot;: 24.5,
                &quot;profundidad&quot;: 10,
                &quot;descripcion&quot;: &quot;Teclado&quot;,
                &quot;numero_guia&quot;: &quot;1acae99bed11b1424527f4c930907fc498273739&quot;,
                &quot;agencia_paquete&quot;: {
					&quot;id&quot;: 8,
					&quot;fecha_arribo&quot;: &quot;2014-09-26T21:29:39.152Z&quot;,
					&quot;tipo_estado&quot;: &quot;R&quot;,
					&quot;paquete&quot;: { Recursivo },
					&quot;agencia&quot;: {
						&quot;id&quot;: 15,
						&quot;nombre&quot;: &quot;Hermes CCS&quot;,
						&quot;ubicacion&quot;: &quot;Caracas&quot;,
						&quot;latitud&quot;: &quot;13554.1546&quot;,
						&quot;longitud&quot;: &quot;5466487.425&quot;,
						&quot;empresa&quot;: &quot;Hermes&quot;,
					}
               	},
                &quot;emisor&quot;: {
                    &quot;id&quot;: 13,
                    &quot;nombre&quot;: &quot;Administrador&quot;,
                    &quot;apellido&quot;: &quot;Prueba&quot;,
                    &quot;correo_electronico&quot;: &quot;a@m.com&quot;,
                    &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-27T00:18:14.693Z&quot;,
                    &quot;tipo_usuario&quot;: {
                        &quot;id&quot;: 1,
                        &quot;nombre&quot;: &quot;Administrador&quot;,
                        &quot;abreviacion&quot;: &quot;A&quot;
                    }
                },
                &quot;receptor&quot;: {
                    &quot;id&quot;: 12,
                    &quot;nombre&quot;: &quot;cliente&quot;,
                    &quot;apellido&quot;: &quot;prueba&quot;,
                    &quot;correo_electronico&quot;: &quot;c@m.com&quot;,
                    &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-26T22:41:43.804Z&quot;,
                    &quot;tipo_usuario&quot;: {
                        &quot;id&quot;: 3,
                        &quot;nombre&quot;: &quot;Usuario Afiliado&quot;,
                        &quot;abreviacion&quot;: &quot;UA&quot;
                    }
                }
            },            
        ],
        &quot;como_receptor&quot;: [
            {
                &quot;id&quot;: 17,
                &quot;ancho&quot;: 2,
                &quot;alto&quot;: 2,
                &quot;peso&quot;: 4,
                &quot;costo&quot;: 2.35,
                &quot;profundidad&quot;: 3,
                &quot;descripcion&quot;: &quot;Test&quot;,
                &quot;numero_guia&quot;: &quot;57921cab6d7d1d1c848747a14336345573dc00fb&quot;,
                &quot;agencia_paquete&quot;: {
					&quot;id&quot;: 8,
					&quot;fecha_arribo&quot;: &quot;2014-09-26T21:29:39.152Z&quot;,
					&quot;tipo_estado&quot;: &quot;R&quot;,
					&quot;paquete&quot;: { Recursivo },
					&quot;agencia&quot;: {
						&quot;id&quot;: 15,
						&quot;nombre&quot;: &quot;Hermes CCS&quot;,
						&quot;ubicacion&quot;: &quot;Caracas&quot;,
						&quot;latitud&quot;: &quot;13554.1546&quot;,
						&quot;longitud&quot;: &quot;5466487.425&quot;,
						&quot;empresa&quot;: &quot;Hermes&quot;,
					}
                },
                &quot;emisor&quot;: {
                    &quot;id&quot;: 14,
                    &quot;nombre&quot;: &quot;operador&quot;,
                    &quot;apellido&quot;: &quot;Prueba&quot;,
                    &quot;correo_electronico&quot;: &quot;o@m.com&quot;,
                    &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-26T21:29:39.060Z&quot;,
                    &quot;tipo_usuario&quot;: {
                        &quot;id&quot;: 2,
                        &quot;nombre&quot;: &quot;Operador&quot;,
                        &quot;abreviacion&quot;: &quot;O&quot;
                    }
                },
                &quot;receptor&quot;: {
                    &quot;id&quot;: 13,
                    &quot;nombre&quot;: &quot;Administrador&quot;,
                    &quot;apellido&quot;: &quot;Prueba&quot;,
                    &quot;correo_electronico&quot;: &quot;a@m.com&quot;,
                    &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-27T00:18:14.693Z&quot;,
                    &quot;tipo_usuario&quot;: {
                        &quot;id&quot;: 1,
                        &quot;nombre&quot;: &quot;Administrador&quot;,
                        &quot;abreviacion&quot;: &quot;A&quot;
                    }
                }
            }
        ]
    }
}</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>numero_guia</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>numero guia del paquete.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>email</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>correo electronico del usuario que ha enviado o recibido el paquete a
listar.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Json</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>representacion en formato json de los paquetes encontrados.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/operador_controller.rb', line 441</span>

<span class='kw'>def</span> <span class='id identifier rubyid_buscar_paquete'>buscar_paquete</span>
	<span class='kw'>begin</span>
		<span class='id identifier rubyid_prms'>prms</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_permit'>permit</span><span class='lparen'>(</span>
			<span class='symbol'>:numero_guia</span><span class='comma'>,</span>
			<span class='symbol'>:email</span>
		<span class='rparen'>)</span>
		
		<span class='kw'>if</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='int'>1</span>
			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Numero de parametros invalidos, solo estan permitidos uno de los siguientes: numero_guia ó email</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>

		<span class='id identifier rubyid_stt'>stt</span> <span class='op'>=</span> <span class='kw'>nil</span>
		
		<span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_prms'>prms</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>numero_guia</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
			<span class='id identifier rubyid_stt'>stt</span> <span class='op'>=</span> <span class='const'>AgenciaPaquete</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span>
				<span class='label'>paquete:</span> <span class='const'>Paquete</span><span class='period'>.</span><span class='id identifier rubyid_find_by!'>find_by!</span><span class='lparen'>(</span>
					<span class='label'>numero_guia:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:numero_guia</span><span class='rparen'>)</span>
				<span class='rparen'>)</span>
			<span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbol'>:fecha_arribo</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse_order'>reverse_order</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

			<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_stt'>stt</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span>

		<span class='kw'>elsif</span> <span class='kw'>not</span> <span class='id identifier rubyid_prms'>prms</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>email</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

			<span class='id identifier rubyid_u'>u</span> <span class='op'>=</span> <span class='const'>Usuario</span><span class='period'>.</span><span class='id identifier rubyid_find_by!'>find_by!</span><span class='lparen'>(</span>
				<span class='label'>correo_electronico:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:email</span><span class='rparen'>)</span>
			<span class='rparen'>)</span>
			<span class='comment'>#stt_e = AgenciaPaquete.joins(:paquete).merge(Paquete.where(emisor: u)).order(:fecha_arribo).reverse_order
</span>			<span class='comment'>#stt_r = AgenciaPaquete.joins(:paquete).merge(Paquete.where(receptor: u)).order(:fecha_arribo).reverse_order
</span>			<span class='id identifier rubyid_stt_e'>stt_e</span> <span class='op'>=</span> <span class='const'>Paquete</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>emisor:</span> <span class='id identifier rubyid_u'>u</span><span class='rparen'>)</span>
			<span class='id identifier rubyid_stt_r'>stt_r</span> <span class='op'>=</span> <span class='const'>Paquete</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>receptor:</span> <span class='id identifier rubyid_u'>u</span><span class='rparen'>)</span>
			<span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span>
				<span class='symbol'>:como_emisor</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_stt_e'>stt_e</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='comma'>,</span>
				<span class='symbol'>:como_receptor</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_stt_r'>stt_r</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span>
			<span class='rbrace'>}</span>

		<span class='kw'>end</span>

		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
				<span class='label'>err_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
				<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OK</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
				<span class='label'>data:</span> <span class='id identifier rubyid_data'>data</span>
			<span class='rbrace'>}</span><span class='comma'>,</span>
			<span class='label'>status:</span> <span class='symbol'>:ok</span>
	<span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
			<span class='label'>err_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error durante la busqueda debido a : </span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
			<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
		<span class='rbrace'>}</span><span class='comma'>,</span>
		<span class='label'>status:</span> <span class='symbol'>:bad_request</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cambiar_estado_paquete-instance_method">
  
    - (<tt>Json</tt>) <strong>cambiar_estado_paquete</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>POST &#39;/operador/paquete/cambiar_estado&#39;</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Parametro &#39;api-token&#39; requerido en cabecera HTTP</p>
</div>
  </div>


<p>Returns representacion en formato json del paquete modificado o 400 en caso
de error.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Ejemplo de json en caso de retorno</p>
</div></p>
      
      <pre class="example code"><code>{
    &quot;err_mssg&quot;: &quot;&quot;,
    &quot;success_mssg&quot;: &quot;OK&quot;,
    &quot;data&quot;: { 
               &quot;id&quot;: 17,
               &quot;ancho&quot;: 2,
               &quot;alto&quot;: 2,
               &quot;peso&quot;: 4,
               &quot;costo&quot;: 2.35,
               &quot;profundidad&quot;: 3,
               &quot;descripcion&quot;: &quot;Test&quot;,
               &quot;numero_guia&quot;: &quot;57921cab6d7d1d1c848747a14336345573dc00fb&quot;,
               &quot;agencia_paquete&quot;: {
				&quot;id&quot;: 8,
				&quot;fecha_arribo&quot;: &quot;2014-09-26T21:29:39.152Z&quot;,
				&quot;tipo_estado&quot;: &quot;R&quot;,
				&quot;paquete&quot;: { Recursivo },
				&quot;agencia&quot;: {
					&quot;id&quot;: 15,
					&quot;nombre&quot;: &quot;Hermes CCS&quot;,
					&quot;ubicacion&quot;: &quot;Caracas&quot;,
					&quot;latitud&quot;: &quot;13554.1546&quot;,
					&quot;longitud&quot;: &quot;5466487.425&quot;,
					&quot;empresa&quot;: &quot;Hermes&quot;,
				}
               },
               &quot;emisor&quot;: {
                   &quot;id&quot;: 14,
                   &quot;nombre&quot;: &quot;operador&quot;,
                   &quot;apellido&quot;: &quot;Prueba&quot;,
                   &quot;correo_electronico&quot;: &quot;o@m.com&quot;,
                   &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-26T21:29:39.060Z&quot;,
                   &quot;tipo_usuario&quot;: {
                       &quot;id&quot;: 2,
                       &quot;nombre&quot;: &quot;Operador&quot;,
                       &quot;abreviacion&quot;: &quot;O&quot;
                   }
               },
               &quot;receptor&quot;: {
                   &quot;id&quot;: 13,
                   &quot;nombre&quot;: &quot;Administrador&quot;,
                   &quot;apellido&quot;: &quot;Prueba&quot;,
                   &quot;correo_electronico&quot;: &quot;a@m.com&quot;,
                   &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-27T00:18:14.693Z&quot;,
                   &quot;tipo_usuario&quot;: {
                       &quot;id&quot;: 1,
                       &quot;nombre&quot;: &quot;Administrador&quot;,
                       &quot;abreviacion&quot;: &quot;A&quot;
                   }
               }
    }
}</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>identificador del paquete.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>agencia</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>identificador de la agencia.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Json</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>representacion en formato json del paquete modificado o 400 en caso de
error.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/operador_controller.rb', line 273</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cambiar_estado_paquete'>cambiar_estado_paquete</span>
	<span class='kw'>begin</span>
		<span class='id identifier rubyid_prms'>prms</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_permit'>permit</span><span class='lparen'>(</span>
			<span class='symbol'>:id</span><span class='comma'>,</span>
			<span class='symbol'>:agencia</span>
		<span class='rparen'>)</span>

		<span class='id identifier rubyid_pq'>pq</span> <span class='op'>=</span> <span class='const'>Paquete</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span>
			<span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
		<span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cambiar_estado'>cambiar_estado</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:agencia</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>

		<span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_pq'>pq</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

			<span class='kw'>if</span> <span class='id identifier rubyid_pq'>pq</span><span class='period'>.</span><span class='id identifier rubyid_tipo_estado'>tipo_estado</span><span class='period'>.</span><span class='id identifier rubyid_abreviacion'>abreviacion</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OA</span><span class='tstring_end'>&#39;</span></span>
				
				<span class='comment'>#Enviar mensaje al receptor del paquete
</span>				<span class='const'>UserMailer</span><span class='period'>.</span><span class='id identifier rubyid_notificar_receptor'>notificar_receptor</span><span class='lparen'>(</span><span class='id identifier rubyid_pq'>pq</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver'>deliver</span>

				<span class='comment'>#Enviar mensaje al emisor del paquete
</span>				<span class='const'>UserMailer</span><span class='period'>.</span><span class='id identifier rubyid_notificar_emisor'>notificar_emisor</span><span class='lparen'>(</span><span class='id identifier rubyid_pq'>pq</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_deliver'>deliver</span>					

			<span class='kw'>end</span>

			<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
					<span class='label'>err_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
					<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cambio de estado satisfactorio a: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pq'>pq</span><span class='period'>.</span><span class='id identifier rubyid_tipo_estado'>tipo_estado</span><span class='period'>.</span><span class='id identifier rubyid_nombre'>nombre</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
					<span class='label'>data:</span> <span class='id identifier rubyid_pq'>pq</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span>
				<span class='rbrace'>}</span><span class='comma'>,</span>
				<span class='label'>status:</span> <span class='symbol'>:ok</span>
		<span class='kw'>else</span>
			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Este paquete no puede cambiar de estado ya que ha sido entregado y no esta bajo el control del sistema</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>
				
	<span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
		<span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Lo sentimos pero ha ocurrido un problema con la modificacion del paquete</span><span class='tstring_end'>&#39;</span></span>
		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
				<span class='label'>err_mssg:</span> <span class='id identifier rubyid_msg'>msg</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> - Motivo: </span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
				<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
			<span class='rbrace'>}</span><span class='comma'>,</span>
			<span class='label'>status:</span> <span class='symbol'>:bad_request</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_api_token-instance_method">
  
    - (<tt>Json</tt>) <strong>check_api_token</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Este metodo es un filtro.</p>
</div>
  </div>


<p>Returns la representacion de un mensaje 403 en  caso de acceso no
autorizado o no contener el parametro &#39;api-token&#39; en la cabecera.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Json</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>la representacion de un mensaje 403 en  caso de acceso no autorizado o no
contener el parametro &#39;api-token&#39; en la cabecera.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/operador_controller.rb', line 505</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_api_token'>check_api_token</span>		
	<span class='kw'>begin</span>
		<span class='kw'>if</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>api-token</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
			<span class='id identifier rubyid_atoken'>atoken</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>api-token</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
		<span class='kw'>else</span>
			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Parametro de identificacion api-token requerido en header http</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>

		<span class='id identifier rubyid_u'>u</span> <span class='op'>=</span> <span class='const'>Usuario</span><span class='period'>.</span><span class='id identifier rubyid_find_by!'>find_by!</span><span class='lparen'>(</span>
			<span class='label'>api_token:</span> <span class='id identifier rubyid_atoken'>atoken</span> 
		<span class='rparen'>)</span>

		<span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_tipo_usuario'>tipo_usuario</span><span class='period'>.</span><span class='id identifier rubyid_abreviacion'>abreviacion</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>O</span><span class='tstring_end'>&quot;</span></span>
			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Se requieren privilegios de operador para tener acceso a estas funcionalidades</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>
	
	<span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
			<span class='label'>err_mssg:</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
			<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
			<span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>status:</span> 	<span class='symbol'>:unauthorized</span>			
	<span class='kw'>end</span>		
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="crear_paquete-instance_method">
  
    - (<tt>Json</tt>) <strong>crear_paquete</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>POST &#39;/operador/paquete/crear&#39;</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Parametro &#39;api-token&#39; requerido en cabecera HTTP</p>
</div>
  </div>


<p>Returns representacion en formato json del numero guia correspondiente al
paquete creado o 400 en caso de error.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Ejemplo de json en caso de retorno</p>
</div></p>
      
      <pre class="example code"><code>{
    &quot;err_mssg&quot;: &quot;&quot;,
    &quot;success_mssg&quot;: &quot;OK&quot;,
    &quot;data&quot;: { 
               &quot;numero_guia&quot;: 25,
               }
}</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>agencia</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>identificador de la agencia.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ancho</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ancho del paquete.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>alto</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>altura del paquete.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>profundidad</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>profundidad del paquete.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>peso</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>peso del paquete.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>costo</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>costo del paquete.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>emisor</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>correo electronico del emisor.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>receptor</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>correo electronico del receptor.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>descripcion</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>descripcion fisica del paquete.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Json</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>representacion en formato json del numero guia correspondiente al paquete
creado o 400 en caso de error.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/operador_controller.rb', line 35</span>

<span class='kw'>def</span> <span class='id identifier rubyid_crear_paquete'>crear_paquete</span>	
	<span class='kw'>begin</span>
		<span class='id identifier rubyid_prms'>prms</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_permit'>permit</span><span class='lparen'>(</span>
			<span class='symbol'>:agencia</span><span class='comma'>,</span>
			<span class='symbol'>:alto</span><span class='comma'>,</span>
			<span class='symbol'>:ancho</span><span class='comma'>,</span>
			<span class='symbol'>:profundidad</span><span class='comma'>,</span>
			<span class='symbol'>:peso</span><span class='comma'>,</span>
			<span class='symbol'>:costo</span><span class='comma'>,</span>
			<span class='symbol'>:emisor</span><span class='comma'>,</span>
			<span class='symbol'>:receptor</span><span class='comma'>,</span>
			<span class='symbol'>:descripcion</span>
		<span class='rparen'>)</span>
		<span class='id identifier rubyid_e'>e</span> <span class='op'>=</span> <span class='const'>Usuario</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>correo_electronico:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:emisor</span><span class='rparen'>)</span><span class='rparen'>)</span>
		<span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='const'>Usuario</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>correo_electronico:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:receptor</span><span class='rparen'>)</span><span class='rparen'>)</span>

		<span class='kw'>if</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Usuario emisor no registrado en el sistema</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>

		<span class='kw'>if</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Usuario receptor no registrado en el sistema</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>	

		<span class='kw'>if</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>==</span> <span class='id identifier rubyid_r'>r</span> 
			<span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No se permite que usuario receptor y emisor sean la misma persona</span><span class='tstring_end'>&quot;</span></span>
		<span class='kw'>end</span>

		<span class='id identifier rubyid_paquete'>paquete</span> <span class='op'>=</span> <span class='const'>Paquete</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span>
			<span class='label'>ancho:</span><span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:ancho</span><span class='rparen'>)</span><span class='comma'>,</span>
			<span class='label'>alto:</span><span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:alto</span><span class='rparen'>)</span><span class='comma'>,</span>
			<span class='label'>peso:</span><span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:peso</span><span class='rparen'>)</span><span class='comma'>,</span>
			<span class='label'>profundidad:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:profundidad</span><span class='rparen'>)</span><span class='comma'>,</span>
			<span class='label'>descripcion:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:descripcion</span><span class='rparen'>)</span><span class='comma'>,</span>
			<span class='label'>costo:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:costo</span><span class='rparen'>)</span><span class='comma'>,</span>
			<span class='label'>emisor_id:</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
			<span class='label'>receptor_id:</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
		<span class='rparen'>)</span>

		<span class='id identifier rubyid_agencia_paquete'>agencia_paquete</span><span class='op'>=</span><span class='const'>AgenciaPaquete</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span>
			<span class='label'>fecha_arribo:</span> <span class='const'>DateTime</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='comma'>,</span>
			<span class='label'>agencia_id:</span> <span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:agencia</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>
			<span class='label'>paquete_id:</span> <span class='id identifier rubyid_paquete'>paquete</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
			<span class='label'>tipo_estado_id:</span> <span class='const'>TipoEstado</span><span class='period'>.</span><span class='id identifier rubyid_find_by'>find_by</span><span class='lparen'>(</span><span class='label'>abreviacion:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>R</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
		<span class='rparen'>)</span>

		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
				<span class='label'>err_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
				<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>El envio se ha registrado exitosamente. Se le notificara por correo si existe alguna novedad.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
				<span class='label'>data:</span> <span class='lbrace'>{</span> <span class='symbol'>:numero_guia</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_paquete'>paquete</span><span class='period'>.</span><span class='id identifier rubyid_numero_guia'>numero_guia</span> <span class='rbrace'>}</span>
 			<span class='rbrace'>}</span><span class='comma'>,</span>
			<span class='label'>status:</span> <span class='symbol'>:created</span>		
	
	<span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
		<span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Lo sentimos pero ha ocurrido un problema con la creacion del paquete</span><span class='tstring_end'>&#39;</span></span>
		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
				<span class='label'>err_mssg:</span> <span class='id identifier rubyid_msg'>msg</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> - Motivo: </span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
				<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
			<span class='rbrace'>}</span><span class='comma'>,</span>
			<span class='label'>status:</span> <span class='symbol'>:bad_request</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ver_paquete-instance_method">
  
    - (<tt>Json</tt>) <strong>ver_paquete</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>GET &#39;/operador/paquete/ver&#39;</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Parametro &#39;api-token&#39; requerido en cabecera HTTP</p>
</div>
  </div>


<p>Returns representacion en formato json del paquete modificado o 400 en caso
de error.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Ejemplo de json en caso de retorno</p>
</div></p>
      
      <pre class="example code"><code>{
    &quot;err_mssg&quot;: &quot;&quot;,
    &quot;success_mssg&quot;: &quot;OK&quot;,
    &quot;data&quot;: {
	    &quot;transaccion&quot;: { 
	    		&quot;id&quot;: 8,
				&quot;fecha_arribo&quot;: &quot;2014-09-26T21:29:39.152Z&quot;,
				&quot;tipo_estado&quot;: &quot;R&quot;,
				&quot;paquete&quot;: { 
					&quot;id&quot;: 17,
	                &quot;ancho&quot;: 2,
	                &quot;alto&quot;: 2,
	                &quot;peso&quot;: 4,
	                &quot;costo&quot;: 2.35,
	                &quot;profundidad&quot;: 3,
	                &quot;descripcion&quot;: &quot;Test&quot;,
	                &quot;numero_guia&quot;: &quot;57921cab6d7d1d1c848747a14336345573dc00fb&quot;,
	                &quot;agencia_paquete&quot;: { Recursivo
	                },
	                &quot;emisor&quot;: {
	                    &quot;id&quot;: 14,
	                    &quot;nombre&quot;: &quot;operador&quot;,
	                    &quot;apellido&quot;: &quot;Prueba&quot;,
	                    &quot;correo_electronico&quot;: &quot;o@m.com&quot;,
	                    &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-26T21:29:39.060Z&quot;,
	                    &quot;tipo_usuario&quot;: {
	                        &quot;id&quot;: 2,
	                        &quot;nombre&quot;: &quot;Operador&quot;,
	                        &quot;abreviacion&quot;: &quot;O&quot;
	                    }
	                },
	                &quot;receptor&quot;: {
	                    &quot;id&quot;: 13,
	                    &quot;nombre&quot;: &quot;Administrador&quot;,
	                    &quot;apellido&quot;: &quot;Prueba&quot;,
	                    &quot;correo_electronico&quot;: &quot;a@m.com&quot;,
	                    &quot;fecha_ultimo_acceso&quot;: &quot;2014-09-27T00:18:14.693Z&quot;,
	                    &quot;tipo_usuario&quot;: {
	                        &quot;id&quot;: 1,
	                        &quot;nombre&quot;: &quot;Administrador&quot;,
	                        &quot;abreviacion&quot;: &quot;A&quot;
	                    }
                },
				&quot;agencia&quot;: {
					&quot;id&quot;: 15,
					&quot;nombre&quot;: &quot;Hermes CCS&quot;,
					&quot;ubicacion&quot;: &quot;Caracas&quot;,
					&quot;latitud&quot;: &quot;13554.1546&quot;,
					&quot;longitud&quot;: &quot;5466487.425&quot;,
					&quot;empresa&quot;: &quot;Hermes&quot;,
			   	}

        }
	}	
}</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>identificador del paquete.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Json</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>representacion en formato json del paquete modificado o 400 en caso de
error.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/operador_controller.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ver_paquete'>ver_paquete</span>
	<span class='kw'>begin</span>
		<span class='id identifier rubyid_prms'>prms</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_permit'>permit</span><span class='lparen'>(</span>
			<span class='symbol'>:id</span>
		<span class='rparen'>)</span>

		<span class='id identifier rubyid_pq'>pq</span> <span class='op'>=</span> <span class='const'>Paquete</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span>
			<span class='id identifier rubyid_prms'>prms</span><span class='period'>.</span><span class='id identifier rubyid_require'>require</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
		<span class='rparen'>)</span>

		<span class='id identifier rubyid_stt'>stt</span> <span class='op'>=</span> <span class='const'>AgenciaPaquete</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span>
				<span class='label'>paquete:</span> <span class='id identifier rubyid_pq'>pq</span>
			<span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span>
					<span class='symbol'>:fecha_arribo</span>
				<span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse_order'>reverse_order</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
				<span class='label'>err_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
				<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OK</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
				<span class='label'>data:</span> <span class='lbrace'>{</span><span class='symbol'>:transaccion</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_stt'>stt</span><span class='period'>.</span><span class='id identifier rubyid_as_json'>as_json</span><span class='rbrace'>}</span>
			<span class='rbrace'>}</span><span class='comma'>,</span>
			<span class='label'>status:</span> <span class='symbol'>:ok</span>

	<span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
		<span class='id identifier rubyid_msg'>msg</span><span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Lo sentimos pero ha ocurrido un problema con la visualizacion del paquete</span><span class='tstring_end'>&#39;</span></span>
		<span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
				<span class='label'>err_mssg:</span> <span class='id identifier rubyid_msg'>msg</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> - Motivo: </span><span class='tstring_end'>&quot;</span></span><span class='op'>+</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
				<span class='label'>success_mssg:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
			<span class='rbrace'>}</span><span class='comma'>,</span>
			<span class='label'>status:</span> <span class='symbol'>:bad_request</span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Nov  4 02:00:41 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.2).
</div>

  </body>
</html>